---
title: "Presentation"
author: "Daniel Jemberu, Giula Minnucci, Rose Camille Vincent"
date: "Thursday, November 27, 2014"
output: ioslides_presentation    
bibliography: bibliographyproject.bib

---


```{r,echo=FALSE,message=FALSE}
library(ggmap)


library(car)
library(ggplot2)
library(RCurl)
library(stargazer)

library(gvlma)

library(robust)

library(het.test)
```

## Research Question

 **What impact does decentralization have on the performance of the health provision system in Benin?**
```{r, echo=FALSE, message=FALSE}
Country_Benin<-qmap(location='benin',zoom=6)
print(Country_Benin)
```


## Description of Benin

- GDP per capita: USD 804.67 in 2013

- GDP growth: 5.6% in 2013

- Population: 10.32 million habitants 

- Human Development Index 2014: 165 out of 187 countries 



##Why Benin?


- Decentralization and devolution have been at the center of national policy for the past decade

- Decentralization: huge transformation of the political and administrative organization

- Decentralization as mechanism to fight poverty and reduce inequality

- Legal provisions has transfered part of health provision competencies to subnational entities 

- Subnational governments have tax raising powers and are allocated transfers to meet assigned expenditures



## Theoretical background

Proponents of decentralization share the view that local governments are the major vehicles for specific poverty alleviation policies. 

**Economic Theory**

- decision-making should occur at the lowest level of government --> allocation efficiency  [@shah1994reform] 

- local government has an informational advantage  [@oates1972fiscal]

- decentralization --> greater participation of nearby communities --> accountability of policymakers [@crook1998democracy]  [@tiebout1956pure]

## Empirical Findings 

**Pros**

- [@santos2005participatory] (Brazil): Decentralization has contributed to double the level of access to basic sanitation and enrollment in elementary schools between 1989 and 1996. Revenue collection increased by 48%. 

- [@bardhan2000capture]: (West Bengal): Fiscal autonomy of local governments expands the volume of service delivery 

- [@faguet2004does] (Bolivia): Public investment in education, water and sanitation rose significantly 

- [@bird1999decentralization] (Asian and Latin-America): Positive effect of decentralization on health, primary education and infrastructure.

- [@galasso2005decentralized] (Bangladesh): Decentralization shifted the balance of power in favor of the poor. 

---

**Cons**

- [@reinikka2004local] (Uganda): Capture of decentralized school grants by local officials in Uganda. 

- [@treisman2000causes]: (developing countries): more levels of government induce higher perceived corruption, less effective provision of public health services 

- [@del2008local] (Indonesia): decentralization leads to yardstick competition between local governments 


## Methodology and Exploratory Data Collection 

*Macroeconomic approach*

Given that health related services is highly decentralized, there might be a strong correlation between the macro-overview and the microeconomic outcome.

- country's health-related public expenditures (WB, WHO) 

- improved sanitation facilities on a macro level


## Macro overview
```{r, include=FALSE}
library(WDI)
healthpublicexpend<-WDI(indicator= c('SH.XPD.PUBL','SH.XPD.PCAP','SH.STA.ACSN'))
Benin<-subset(healthpublicexpend,country=='Benin')
Benin$iso2c<-NULL
names(Benin)[names(Benin)=="year"] <- "Year"
names(Benin)[names(Benin)=="SH.XPD.PUBL"] <- "Public.Health.Expenditure"
names(Benin)[names(Benin)=="SH.XPD.PCAP"] <- "Health.Expenditure.Per.Capita"
names(Benin)[names(Benin)=="SH.STA.ACSN"] <- "Improved.Sanitation.Facilities"

```

```{r,include=FALSE}
infrastructures <- read.csv("http://apps.who.int/gho/athena/data/data-text.csv?target=GHO/DEVICES01,DEVICES02,DEVICES03,DEVICES04,DEVICES05&profile=text&filter=COUNTRY:*;REGION:AFR;REGION:AMR;REGION:SEAR;REGION:EUR;REGION:EMR;REGION:WPR")
Benininfra<-subset(infrastructures,Country=='Benin')
Benininfra$PUBLISH.STATES<-NULL
Benininfra$WHO.region<-NULL
Benininfra$Low<-NULL
Benininfra$High<-NULL
Benininfra$Comments<-NULL
library(dplyr)
messy<-data.frame(
  Indicator=c("District/rural hospitals", "Health centres","Provincial hospitals","Specialized hospitals","Provincial hospitals","Specialized hospitals"),
  Year=c(2010,2010,2010,2010,2013,2013),
  Country=c("Benin","Benin","Benin","Benin","Benin","Benin"),
  Display.Value=c(0.29,6.36,0.06,0.12,0.05,0.11)
  )
library(tidyr)
tidy<-spread(messy,Indicator,Display.Value)
```

```{r, include=FALSE}
names(Benin)[names(Benin)=="country"] <- "Country"
total<-merge(Benin,tidy, by=c("Country","Year"),all=TRUE)
```

```{r, echo=FALSE}
ggplot(data=Benin,aes(x=Year,y=Public.Health.Expenditure)) + geom_line() + geom_point() +theme_bw(base_size=9) + ggtitle("Trend of total public expenditure over the years\n")
```

---

```{r, echo=FALSE}

ggplot(data=Benin, aes(x=Year,y=Health.Expenditure.Per.Capita)) + geom_line() + geom_point() + theme_bw(base_size = 9) + ggtitle("Trend over the years\n")
``` 
 
---

```{r,echo=FALSE}
ggplot(data=Benin, aes(x=Year,y=Improved.Sanitation.Facilities)) +geom_line() + geom_point() + theme_bw(base_size = 9) + ggtitle("Trend over the years\n")
```


## Micro analysis

**Estimated Model**

$$ D = \alpha + \beta_{1}Decentralization + \beta_{2}Log Population + \beta_{3}Density + \beta_{4}Log Public Expenditures 
+ \beta_{5}Log Comsumption per Capita + \beta_{6}Education + \beta_{7}PovertyIndex + \beta_{8}Gini Coefficient + \beta_{9}Perception on Decentralization + e $$

- Independent variable: Decentralization
---

<div class="columns-2">
- Dependent variables:

  + access to water
  
  + access to toilet facilities
  
  + water provision infrastructure
  
  + healthcare centers (hospitals)
    
-  Explanatory variables: 

 + population, population density 
 
 + per capita consumption, public expenditure per capita, households health consumption
 
 + monetary poverty index, average literacy rate of the head of households
 
 + gini coefficient 
</div>

## Results 

```{r,include=FALSE}
url2 <- "https://raw.githubusercontent.com/giumin/Third_Assignment/gh-pages/decenthealth.csv"
combineddata.data <- getURL(url2, ssl.verifypeer = FALSE)                
combineddata.data <- read.csv(textConnection(combineddata.data))
```

```{r, echo=FALSE, results='asis'}
stargazer(combineddata.data[c("pop_wateraccess","pop_toiletacess","pubhosp","connect_soneb")], type = 'html', title="Descriptive statistics of dependent variables", digits=2)
```
---
**Effect of Decentralization on Water Access**

```{r,include=FALSE, results='asis'}
# First regression:water acces
R1water <- lm(pop_wateraccess ~ decentralization2, data = combineddata.data)
confint(R1water)
summary(R1water)

# Second regression: water access
R2water <- lm(pop_wateraccess ~ decentralization2 + log(population) + Density, data = combineddata.data)
summary(R2water)

# Third regression: water access
R3water <- lm(pop_wateraccess ~ decentralization2 + log(population) + Density + log(pubexp.c) + log(consump.c) + cons_health + educ_adult + ind_pauv_mon + gini + for_dentr., data = combineddata.data)
summary(R3water)
```

---
```{r,echo=FALSE,results='asis'}


#Testing for multicollinearity among variables
vif(R3water)
sqrt(vif(R3water)) > 2

# Evaluate homoscedasticity
#   non-constant error variance test
ncvTest(R3water)
#   Beusch-Pagan test
bptest(R3water)

# Global test of model assumptions
gvmodelwater <- gvlma(R3water) 
summary(gvmodelwater)

```

---
```{r, echo=FALSE, results='asis'}
labels <- c('Decentralization', 'Population', 'Population Density', 'Log Public Expenditure per capita', 'Log Consumption per Capita', 'Average Households Health Consumption Ratio', 'Average Literacy Rate of Head of Households', 'Monetary Poverty Index','(Intercept)')
stargazer::stargazer(R1water, R2water, R3water, covariate.labels = labels,
                     title = 'Effect of decentralization on water access',
                     digits = 2, type = 'html', header = FALSE)
```

---
**Effect of Decentralization on Access to toilet facilities**

```{r,include=FALSE, results='asis'}
# First regression:water acces
R1toilet <- lm(pop_toiletacess ~ decentralization2, data = combineddata.data)
summary(R1toilet)

# Second regression: water access
R2toilet <- lm(pop_toiletacess  ~ decentralization2 + log(population) + Density, data = combineddata.data)
summary(R2toilet)

# Third regression: water access
R3toilet <- lm(pop_toiletacess ~ decentralization2 + log(population) + Density + log(pubexp.c) + log(consump.c) + cons_health + educ_adult + ind_pauv_mon + gini + for_dentr., data = combineddata.data)
summary(R3toilet)

```
---

```{r,echo=FALSE,results='asis'}

#Testing for multicollinearity among variables
vif(R3toilet)
sqrt(vif(R3toilet)) > 2

# Evaluate homoscedasticity
#   non-constant error variance test
ncvTest(R3toilet)
#   Beusch-Pagan test
bptest(R3toilet)

# Global test of model assumptions
gvmodeltoilet <- gvlma(R3toilet) 
summary(gvmodeltoilet)

```

---
```{r, echo=FALSE, results='asis'}
labels <- c('Decentralization', 'Population', 'Population Density', 'Log Public Expenditure per capita', 'Log Consumption per Capita', 'Average Households Health Consumption Ratio', 'Average Literacy Rate of Head of Households', 'Monetary Poverty Index','(Intercept)')
stargazer::stargazer(R1toilet, R2toilet, R3toilet, covariate.labels = labels,
                     title = 'Effect of decentralization on access to toilet facilities',
                     digits = 2, type = 'html', header = FALSE)
```

---
**Effect of Decentralization on provision of water facilities**

```{r,include=FALSE, results='asis'}
# First regression:water acces
R1soneb <- lm(connect_soneb ~ decentralization2, data = combineddata.data)
summary(R1soneb)

# Second regression: water access
R2soneb <- lm(connect_soneb ~ decentralization2 + log(population) + Density, data = combineddata.data)
summary(R2soneb)

# Third regression: water access
R3soneb <- lm(connect_soneb ~ decentralization2 + log(population) + Density + log(pubexp.c) + log(consump.c) + cons_health + educ_adult + ind_pauv_mon + gini + for_dentr., data = combineddata.data)
summary(R3soneb)
```
---

```{r, echo=FALSE, results='asis'}

#Testing for multicollinearity among variables
vif(R3soneb)
sqrt(vif(R3soneb)) > 2

# Evaluate homoscedasticity
#   non-constant error variance test
ncvTest(R3soneb)
#   Beusch-Pagan test
bptest(R3soneb)

# Global test of model assumptions
gvmodelsoneb <- gvlma(R3soneb) 
summary(gvmodelsoneb)


## Heteroskedastic robust standard errors in R
require("sandwich")
require("lmtest")

R3soneb$newse<-vcovHC(R3soneb)
coeftest(R3soneb,R3soneb$newse)

```

---

```{r, echo=FALSE, results='asis'}
labels <- c('Decentralization', 'Population', 'Population Density', 'Log Public Expenditure per capita', 'Log Consumption per Capita', 'Average Households Health Consumption Ratio', 'Average Literacy Rate of Head of Households', 'Monetary Poverty Index','(Intercept)')
stargazer::stargazer(R1soneb, R2soneb, R3soneb, covariate.labels = labels,
                     title = 'Effect of decentralization on provision of water facilities',
                     digits = 2, type = 'html', header = FALSE)
```

---
**Effect of Decentralization on provision of public healthcare facilities**

```{r,include=FALSE, results='asis'}
# First regression:water acces
R1pubhosp <- lm(pubhosp ~ decentralization2, data = combineddata.data)
summary(R1pubhosp)

# Second regression: water access
R2pubhosp <- lm(pubhosp ~ decentralization2 + log(population) + Density, data = combineddata.data)
summary(R2pubhosp)

# Third regression: water access
R3pubhosp <- lm(pubhosp ~ decentralization2 + log(population) + Density + log(pubexp.c) + log(consump.c) + cons_health + educ_adult + ind_pauv_mon + gini + for_dentr., data = combineddata.data)
summary(R3pubhosp)
```
---
```{r, echo=FALSE,results='asis'}

# Global test of model assumptions
gvmodelpubhosp <- gvlma(R3pubhosp) 
summary(gvmodelpubhosp)

#Testing for multicollinearity among variables
vif(R3pubhosp)
sqrt(vif(R3pubhosp)) > 2

# Evaluate homoscedasticity
#   non-constant error variance test
ncvTest(R3pubhosp)
#   Beusch-Pagan test
bptest(R3pubhosp)

```

---

```{r, echo=FALSE, results='asis'}
labels <- c('Decentralization', 'Population', 'Population Density', 'Log Public Expenditure per capita', 'Log Consumption per Capita', 'Average Households Health Consumption Ratio', 'Average Literacy Rate of Head of Households', 'Monetary Poverty Index','(Intercept)')
stargazer::stargazer(R1pubhosp, R2pubhosp, R3pubhosp, covariate.labels = labels,
                     title = 'Effect of decentralization on provision of public healthcare facilities',
                     digits = 2, type = 'html', header = FALSE)
```

